USE ISRS


DROP TABLE IF EXISTS #CT_INSTR
SELECT
CONCAT(YRTR, '-', COU_ID) AS RECORD_ID,
CONCAT(V_STARID.FIRST_NAME, ' ', V_STARID.LAST_NAME) AS FACULTY_NAME,
V_HEMPT_COND_DESC
INTO #CT_INSTR
FROM CT_INSTR
JOIN V_STARID
ON CT_INSTR.INSTR_ID = V_STARID.TECH_ID
WHERE YRTR >=20193 
JOIN V_HR_EMPL_PERSON_PUBLIC
ON CT_INSTR.INSTR_ID = V_HR_EMPL_PERSON_PUBLIC.TECH_ID

DROP TABLE IF EXISTS #CT_COU
SELECT 
CONCAT(YRTR,'-',COU_ID) RECORD_ID,
CT_COU.YRTR,
CT_COU.COU_ID,
CT_COU.SUBJ,
CT_COU.COU_NBR,
CT_COU.TITLE,
CT_COU.SECT_NBR,
CT_COU.PRMRY_CIP_ID
INTO #CT_COU
FROM CT_COU
WHERE YRTR >=20193 
DROP TABLE IF EXISTS #FIRST_PART
SELECT
YRTR,
CONCAT(SUBJ, COU_NBR, '-', SECT_NBR,' ', TITLE) AS COURSE_NAME,
FACULTY_NAME
INTO #FIRST_PART
FROM #CT_COU
JOIN #CT_INSTR
ON #CT_COU.RECORD_ID = #CT_INSTR.RECORD_ID
